import numpy as npimport matplotlibimport matplotlib.pyplot as pltfrom mpl_toolkits.mplot3d import Axes3Dimport scipyimport randomM = 200tym, dta = np.loadtxt('/home/rinku/XOOPIC/xoopic/Antenna/den_1e16/datafile.txt', unpack=True)n = len(dta) // Mtym = np.reshape(tym, (M, n))dta = np.reshape(dta, (M, n))for i in range(M):    dta[i,:] = dta[i,:] - np.mean(dta[i,:])        dt = tym[0, 1] - tym[0, 0] fdt = np.zeros((M, n), dtype=complex)fqs = np.linspace(0, n//2-1, n//2) / dtfor i in range(M):    fdt[i] = np.fft.fft(dta[i])#plt.figure(1)#plt.plot(np.abs(fdt1[1]))# plt.show()bsp = np.zeros((n//2, n//2))for k1 in range(n//2):    for k2 in range(k1, n//2-k1):        bsp[k1,k2] = np.abs(np.sum(fdt[:,k1] * fdt[:,k2] * np.conj(fdt[:,k1+k2])))        bsp[k1,k2] = bsp[k1,k2] / np.sqrt(np.sum(np.abs(fdt[:,k1] * fdt[:,k2]) ** 2))        bsp[k1,k2] = bsp[k1,k2] / np.sqrt(np.sum(np.abs(fdt[:,k1+k2]) ** 2))#fig = plt.figure()#ax = fig.add_subplot(111, projection='3d')xx,yy = np.meshgrid(np.linspace(0, n//2-1, n//2), np.linspace(0, n//2-1, n//2))#ax = fig.add_subplot(111, projection='3d')xx,yy = np.meshgrid(np.linspace(0, n//2-1, n//2), np.linspace(0, n//2-1, n//2))#ax.plot_surface(xx, yy, bsp ** 2)#ax.set_zlim(0, 1)cmp=matplotlib.colors.Colormap('hot')fig = plt.figure(figsize=(7,5))plt.contourf(bsp[:50, :50], levels=np.linspace(0, 1, 100), cmap=plt.cm.jet)plt.xlabel('frequency',fontsize=15)plt.ylabel('frequency',fontsize=15)plt.xticks(fontsize=12)plt.yticks(fontsize=12)plt.title('Near mid region (Pressure  - 0.07 Torr)',fontsize=15)plt.colorbar()plt.show()# plt.savefig('Bi_spectral_analysis.png')